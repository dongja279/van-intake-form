<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>VAN êµì²´ ê²¬ì  ìš”ì²­</title>
  <style>
    :root{--bg:#0b0b0b;--card:#151515;--ink:#f5f5f5;--muted:#b9b9b9;--accent:#3aa0ff;--danger:#ff6b6b}
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Malgun Gothic,sans-serif}
    .wrap{max-width:720px;margin:0 auto;padding:20px}
    .banner{background:linear-gradient(180deg,#1f2937,#111827);border:1px solid #2a2a2a;border-radius:16px;padding:16px 14px;margin-bottom:14px}
    .banner strong{display:block;font-size:15px;line-height:1.4}
    .banner .small{color:var(--muted);font-size:12px;margin-top:8px}
    .card{background:var(--card);border:1px solid #2a2a2a;border-radius:16px;padding:16px}
    .title{font-size:18px;margin:0 0 8px}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    label{display:block;font-size:13px;color:var(--muted);margin:12px 0 6px}
    label.required::after{content:" *";color:var(--danger)}
    input,select,button{width:100%;padding:14px 12px;border-radius:12px;border:1px solid #2b2b2b;background:#0f0f10;color:var(--ink);font-size:15px;outline:none}
    input::placeholder{color:#8d8d8d}
    input.error{border-color:var(--danger)}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .pill{display:inline-flex;gap:6px;background:#0f0f10;border:1px solid #2b2b2b;padding:6px 10px;border-radius:999px;align-items:center}
    .section{margin-top:8px}
    .hide{display:none}
    .actions{display:flex;gap:10px;margin-top:16px}
    .primary{background:var(--accent);border:1px solid #348fe3;font-weight:600}
    .help{font-size:12px;color:#8a8a8a;margin-top:6px}
    .ok{color:#c7ffea}.err{color:#ffb6b6}
    footer{margin:28px 0 8px;color:#7b7b7b;font-size:12px;text-align:center}
    .hgroup{margin-top:18px;border-top:1px dashed #2a2a2a;padding-top:12px}
    .hgroup h3{margin:0 0 6px;font-size:15px}
    .faq-title{margin:18px 0 8px;font-size:16px}
    details{border:1px solid #2b2b2b;border-radius:12px;background:#0f0f10;margin:8px 0}
    summary{cursor:pointer;padding:12px 14px;font-size:14px;color:#e6e6e6;list-style:none}
    details[open] summary{border-bottom:1px solid #232323}
    details .answer{padding:12px 14px;color:#bdbdbd;font-size:13px;line-height:1.55}
    summary::-webkit-details-marker{display:none}
    .spinner{display:inline-block;width:16px;height:16px;border:2px solid #9ecbff;border-top-color:transparent;border-radius:50%;animation:spin .8s linear infinite;vertical-align:middle;margin-right:6px}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="banner">
      <strong>ì•„ë˜ ì •ë³´ë¥¼ ì…ë ¥ í•´ ì£¼ì‹œë©´ ê²¬ì  ì‚°ì¶œ í›„ ì¼ì£¼ì¼ ë‚´ë¡œ ì—°ë½ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</strong>
      <div class="small">ë¬¸ì˜ : í•œêµ­ê²°ì œì†”ë£¨ì…˜ ë°°ì¤€ì²  ëŒ€í‘œ 010-4180-8867</div>
    </div>

    <div class="card">
      <h2 class="title">VAN êµì²´ ì ì¬ê³ ê° ì…ë ¥ í¼</h2>

      <label for="bizType">ì—…ì¢… ì„ íƒ</label>
      <div class="row" role="radiogroup" aria-label="ì—…ì¢… ì„ íƒ">
        <button class="pill" type="button" id="btn-food"><span>ğŸ½ï¸</span><span>ì‹ë‹¹</span></button>
        <button class="pill" type="button" id="btn-hospital"><span>ğŸ¥</span><span>ë³‘ì›</span></button>
      </div>
      <input type="hidden" id="bizType" value="ì‹ë‹¹"/>

      <!-- ì‹ë‹¹ -->
      <div id="foodSection" class="section">
        <div class="hgroup">
          <h3>1) ì‹ë‹¹ì •ë³´</h3>
          <label class="required">ì—…ì²´ëª…</label><input id="r_name" type="text" placeholder="ì˜ˆ) ì•ˆë™ë’·ê³ ê¸° ê°•ë‚¨ì " />
          <label>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</label><input id="r_bizno" type="text" inputmode="numeric" placeholder="123-45-67890" />
          <div class="help">ìˆ«ìë§Œ ì…ë ¥í•´ë„ ìë™ìœ¼ë¡œ í•˜ì´í”ˆì„ ë¶™ì…ë‹ˆë‹¤.</div>
          <label class="required">ë‹´ë‹¹ìëª…</label><input id="r_person" type="text" placeholder="ì˜ˆ) í™ê¸¸ë™" />
          <label class="required">ì—°ë½ì²˜</label><input id="r_phone" type="tel" inputmode="numeric" placeholder="010-1234-5678" />
        </div>
        <div class="hgroup">
          <h3>2) ê¸°ì¡´ í¬ìŠ¤ê¸° ì •ë³´</h3>
          <label>ì—…ì²´(í”„ë¡œê·¸ë¨) ëª…</label><input id="r_pos_name" type="text" placeholder="ì˜ˆ) ì˜¤ì¼€ì´í¬ìŠ¤" />
          <label>ê³„ì•½ê¸°ê°„</label>
          <div class="grid-2"><input id="r_contract_s" type="date" /><input id="r_contract_e" type="date" /></div>
          <label>ìœ„ì•½ê¸ˆ(ìµì›” ë§ ê¸°ì¤€)</label><input id="r_penalty" type="number" min="0" step="1" placeholder="ì²œì› ë‹¨ìœ„" />
        </div>
        <div class="hgroup">
          <h3>3) ì„¤ì¹˜ëœ ë‹¨ë§ê¸° ì •ë³´</h3>
          <label>í¬ìŠ¤ê¸° ëŒ€ìˆ˜(ë©”ì¸í¬ìŠ¤, ì˜¤ë”í¬ìŠ¤ ë“±)</label><input id="r_poscnt" type="number" min="0" step="1" placeholder="ì˜ˆ) 2" />
        </div>
        <div class="hgroup">
          <h3>4) ì „ë…„ë„ ì¹´ë“œë§¤ì¶œ(VAT í¬í•¨)</h3>
          <label>ì „ë…„ë„ ê¸°ì¤€ ì¹´ë“œë§¤ì¶œ ì´ì•¡(ë°±ë§Œì›)</label><input id="r_sales_amt" type="number" min="0" step="1" placeholder="ì˜ˆ) 850" />
          <label>ì „ë…„ë„ ê¸°ì¤€ ì¹´ë“œë§¤ì¶œ ê±´ ìˆ˜(ê±´)</label><input id="r_sales_cnt" type="number" min="0" step="1" placeholder="ì˜ˆ) 12450" />
        </div>
      </div>

      <!-- ë³‘ì› -->
      <div id="hospitalSection" class="section hide">
        <div class="hgroup">
          <h3>1) ë³‘ì›ì •ë³´</h3>
          <label class="required">ì—…ì²´ëª…</label><input id="h_name" type="text" placeholder="ì˜ˆ) í•œêµ­ì˜ì›" />
          <label>ì‚¬ì—…ì ë“±ë¡ ë²ˆí˜¸</label><input id="h_bizno" type="text" inputmode="numeric" placeholder="123-45-67890" />
          <label class="required">ë‹´ë‹¹ìëª…</label><input id="h_person" type="text" placeholder="ì˜ˆ) ê¹€ì›ì¥" />
          <label class="required">ì—°ë½ì²˜</label><input id="h_phone" type="tel" inputmode="numeric" placeholder="010-1234-5678" />
        </div>
        <div class="hgroup">
          <h3>2) ê¸°ì¡´ EMR ì—…ì²´ ì •ë³´</h3>
          <label>ì—…ì²´ëª…</label><input id="h_emr_name" type="text" />
          <label>ë‹´ë‹¹ìëª…</label><input id="h_emr_person" type="text" />
          <label>ì—°ë½ì²˜</label><input id="h_emr_phone" type="tel" inputmode="numeric" placeholder="010-1234-5678" />
          <label>EMR ì—…ì²´ ë³€ê²½ ê°€ëŠ¥ ì—¬ë¶€</label>
          <select id="h_emr_switch"><option value="">ì„ íƒ</option><option>ê°€ëŠ¥</option><option>ë¶ˆê°€</option><option>ê²€í†  í•„ìš”</option></select>
        </div>
        <div class="hgroup">
          <h3>3) ê¸°ì¡´ Van ì—…ì²´ ì •ë³´</h3>
          <label>ì—…ì²´ëª…</label><input id="h_van_name" type="text" />
          <label>ê³„ì•½ê¸°ê°„</label><div class="grid-2"><input id="h_van_contract_s" type="date" /><input id="h_van_contract_e" type="date" /></div>
          <label>ìœ„ì•½ê¸ˆ(ìµì›” ë§ ê¸°ì¤€)</label><input id="h_van_penalty" type="number" min="0" step="1" placeholder="ì²œì› ë‹¨ìœ„" />
        </div>
        <div class="hgroup">
          <h3>4) ì¹´ë“œ ë‹¨ë§ê¸°(ë¦¬ë”ê¸°) ì •ë³´</h3>
          <label>ë‹¨ë§ê¸°(ë¦¬ë”ê¸°) ëŒ€ìˆ˜</label><input id="h_reader_count" type="number" min="0" step="1" placeholder="ì˜ˆ) 3" />
        </div>
        <div class="hgroup">
          <h3>5) ì „ë…„ë„ ì¹´ë“œë§¤ì¶œ(VAT í¬í•¨)</h3>
          <label>100ë§Œì› ì´í•˜ ê±´ ìˆ˜(ê±´)</label><input id="h_under_cnt" type="number" min="0" step="1" />
          <label>100ë§Œì› ì´í•˜ ë§¤ì¶œ í•©ê³„(ë°±ë§Œ)</label><input id="h_under_amt" type="number" min="0" step="1" />
          <label>100ë§Œì› ì´ìƒ ê±´ ìˆ˜(ê±´)</label><input id="h_over_cnt" type="number" min="0" step="1" />
          <label>100ë§Œì› ì´ìƒ ë§¤ì¶œ í•©ê³„(ë°±ë§Œ)</label><input id="h_over_amt" type="number" min="0" step="1" />
        </div>
      </div>

      <div class="actions">
        <button id="btnSubmit" class="primary" type="button">ì œì¶œ</button>
      </div>
      <div id="result" class="help" aria-live="polite" style="margin-top:10px"></div>
    </div>

    <!-- FAQ -->
    <div class="card" style="margin-top:12px">
      <h2 class="faq-title">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸(FAQ)</h2>

      <div id="faq-food">
        <details><summary>VAN êµì²´ ì „ì²´ ì ˆì°¨ëŠ”?</summary>
          <div class="answer">ìƒë‹´ â†’ ìˆ˜ìˆ˜ë£Œ ì‹œë®¬ë ˆì´ì…˜ â†’ ê²¬ì Â·ê³„ì•½ â†’ ì„¤ì¹˜/ì„¸íŒ… â†’ ì •ì‚° ê³„ì¢Œ ë³€ê²½ â†’ 1ê°œì›” ëª¨ë‹ˆí„°ë§. í‰ê·  3~7ì¼.</div>
        </details>
        <details><summary>POSëŠ” ê·¸ëŒ€ë¡œ ë‘ê³  VANë§Œ ë°”ê¿€ ìˆ˜ ìˆë‚˜?</summary>
          <div class="answer">ëŒ€ë¶€ë¶„ ê°€ëŠ¥. POSì‚¬ ì—°ë™ ë°©ì‹ë§Œ í™•ì¸í•˜ë©´ ëœë‹¤. í•„ìš” ì‹œ POSì‚¬ì™€ ì§ì ‘ ì¡°ìœ¨.</div>
        </details>
        <details><summary>ìœ„ì•½ê¸ˆì´ ìˆìœ¼ë©´ ì „í™˜ì´ ì–´ë µë‚˜?</summary>
          <div class="answer">ì•„ë‹ˆë‹¤. ì”ì—¬ê¸°ê°„Â·ìœ„ì•½ê¸ˆ ëŒ€ë¹„ ìˆ˜ìˆ˜ë£Œ ì ˆê°íš¨ê³¼ë¥¼ ì‚°ì¶œí•´ ì†ìµë¶„ê¸°ì ì„ ì œì‹œí•œë‹¤.</div>
        </details>
        <details><summary>ìˆ˜ìˆ˜ë£ŒëŠ” ë¬´ì—‡ìœ¼ë¡œ ê²°ì •ë˜ë‚˜?</summary>
          <div class="answer">ì „ë…„ë„ ë§¤ì¶œ/ê±´ìˆ˜, ì—…ì¢…, ë‹¨ë§ê¸° ìˆ˜, ê°„í¸ê²°ì œ ë¹„ì¤‘ ë“±. ì…ë ¥ê°’ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜í•œë‹¤.</div>
        </details>
        <details><summary>ì •ì‚° ì£¼ê¸°ì™€ ì…ê¸ˆ ì‹œì ì€?</summary>
          <div class="answer">ê¸°ë³¸ D+2 ë˜ëŠ” ì£¼ê°„ì •ì‚°. ê¸°ì¡´ ì£¼ê¸° ìœ ì§€ ê°€ëŠ¥.</div>
        </details>
        <details><summary>ì„¤ì¹˜ëŠ” ì˜ì—… ì¤‘ë‹¨ ì—†ì´ ê°€ëŠ¥í•œê°€?</summary>
          <div class="answer">ê°€ëŠ¥. í¬ìŠ¤ 1ëŒ€ ê¸°ì¤€ 30~60ë¶„. í”¼í¬ íƒ€ì„ íšŒí”¼ ìŠ¤ì¼€ì¤„ë¡œ ì§„í–‰.</div>
        </details>
        <details><summary>ê°„í¸ê²°ì œ ì´ê´€ê³¼ ì‹ ê·œ ì±„ë„ ì¶”ê°€ëŠ”?</summary>
          <div class="answer">ê°€ëŠ¥. ì¹´ì¹´ì˜¤/ë„¤ì´ë²„/ì œë¡œí˜ì´ ë“± ì´ê´€Â·ì‹ ê·œ ê°œí†µ ì§€ì›.</div>
        </details>
        <details><summary>ì¶”ê°€ ë¹„ìš©ì€?</summary>
          <div class="answer">ê¸°ë³¸ ì„¤ì¹˜Â·ì„¸íŒ… ë¬´ìƒ. íŠ¹ìˆ˜ ì¥ë¹„ë‚˜ ê³µì‚¬ëŠ” ë³„ë„ í˜‘ì˜.</div>
        </details>
        <details><summary>A/SëŠ” ëˆ„ê°€ ë‹´ë‹¹í•˜ë‚˜?</summary>
          <div class="answer">í•œêµ­ê²°ì œì†”ë£¨ì…˜ ì§€ì—­ ê¸°ì‚¬ì™€ í˜‘ë ¥ POS ëŒ€ë¦¬ì ì´ 365ì¼ ì›ê²©Â·í˜„ì¥ ì§€ì›.</div>
        </details>
      </div>

      <div id="faq-hospital" class="hide">
        <details><summary>ë³‘ì› VAN êµì²´ ì ˆì°¨ëŠ”?</summary>
          <div class="answer">í˜„í™© ì ê²€(EMR/ìˆ˜ë‚©íë¦„) â†’ ìˆ˜ìˆ˜ë£ŒÂ·ì •ì‚° êµ¬ì¡° ì„¤ê³„ â†’ EMR ì—°ë™ í…ŒìŠ¤íŠ¸ â†’ ì„¤ì¹˜Â·ê²€ìˆ˜ â†’ ì‹œë‚˜ë¦¬ì˜¤ ì ê²€ â†’ 1ê°œì›” ëª¨ë‹ˆí„°ë§.</div>
        </details>
        <details><summary>EMR ì—°ë™ í™•ì¸ì€?</summary>
          <div class="answer">EMR ì—…ì²´Â·ì—°ë™ ë°©ì‹ í™•ì¸ í›„, í•„ìš” ì‹œ EMRì‚¬ì™€ ì§ì ‘ í˜‘ì˜í•´ í‚¤Â·ì„¤ì • ì´ê´€.</div>
        </details>
        <details><summary>ë³´í—˜/ë¹„ê¸‰ì—¬Â·í˜„ê¸ˆì˜ìˆ˜ì¦ ì²˜ë¦¬?</summary>
          <div class="answer">ë™ì¼í•˜ê²Œ ê°€ëŠ¥. ë¦¬ë”ê¸°Â·í”„ë¦°í„° ì„¸íŒ…ì„ EMR ì›Œí¬í”Œë¡œìš°ì— ë§ì¶° êµ¬ì„±.</div>
        </details>
        <details><summary>ì—¬ëŸ¬ ì°½êµ¬ì˜ ë¦¬ë”ê¸° ëŒ€ìˆ˜ ì‚°ì •?</summary>
          <div class="answer">ë™ì‹œ ì²˜ë¦¬ëŸ‰ê³¼ í”¼í¬ íƒ€ì„ ê¸°ì¤€ ì‚°ì •. ì˜ˆë¹„ 1ëŒ€ ê¶Œì¥.</div>
        </details>
        <details><summary>ì •ì‚°Â·ëª…ì„¸ì„œ ì œê³µ?</summary>
          <div class="answer">D+2 ë˜ëŠ” ì£¼ê°„ì •ì‚°. ê³¼/ì°½êµ¬ë³„ ë¶„ë¦¬ ë¦¬í¬íŠ¸ì™€ ì›”ë³„ ëª…ì„¸ì„œ ì´ë©”ì¼ ìë™ ë°œì†¡ ê°€ëŠ¥.</div>
        </details>
        <details><summary>EMR ê³„ì•½Â·ë°ì´í„° ì˜í–¥?</summary>
          <div class="answer">ì—†ìŒ. VANë§Œ ë³€ê²½. EMR ì„¤ì •ê°’ ì¼ë¶€ ë³€ê²½ í•„ìš” ê°€ëŠ¥.</div>
        </details>
        <details><summary>ë³´ì•ˆê³¼ í™˜ìì •ë³´ ë³´í˜¸?</summary>
          <div class="answer">ì¹´ë“œì •ë³´ëŠ” ë‹¨ë§ì—ì„œ ì•”í˜¸í™”. í™˜ìì •ë³´ëŠ” EMRì—ë§Œ ì €ì¥. PCI-DSS ì¤€ìˆ˜.</div>
        </details>
        <details><summary>ìœ„ì•½ê¸ˆ ìˆì–´ë„ êµì²´?</summary>
          <div class="answer">ê°€ëŠ¥. ì ˆê°ì•¡ ë¶„ì„ í›„ ìµœì  ì „í™˜ ì‹œì  ì œì•ˆ.</div>
        </details>
        <details><summary>ìœ ì§€ë³´ìˆ˜Â·ì¥ì•  ëŒ€ì‘?</summary>
          <div class="answer">365ì¼ ì½œì„¼í„°Â·ì§€ì—­ ì—”ì§€ë‹ˆì–´ ì§€ì›. ë¦¬ë”ê¸° êµì²´ SLA ëª…ì‹œ ê°€ëŠ¥.</div>
        </details>
      </div>
    </div>

    <footer>Â© í•œêµ­ê²°ì œì†”ë£¨ì…˜ VAN íŒŒíŠ¸ë„ˆ</footer>
  </div>

  <script>
    // === ì„¤ì • ===
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxrnHKrybKHFU-Gvni3GYt5-54WDi9Wzajh3BxzICoGiA7Kf9fULvn3mG53xJyoABPj9w/exec";

    // === ìœ í‹¸: ìˆ«ìë§Œ ===
    const onlyDigits = s => (s||"").replace(/\D+/g,"");

    // === ìë™ í•˜ì´í”ˆ í¬ë§·í„° ===
    function formatPhone(raw){
      const d = onlyDigits(raw).slice(0,11); // ìµœëŒ€ 11ìë¦¬
      if(d.startsWith("02")){
        if(d.length<=2) return d;
        if(d.length<=5) return d.replace(/(\d{2})(\d+)/,"$1-$2");
        if(d.length<=9) return d.replace(/(\d{2})(\d{3,4})(\d{0,4})/,"$1-$2-$3");
        return d.replace(/(\d{2})(\d{4})(\d{4})/,"$1-$2-$3");
      }else{
        if(d.length<=3) return d;
        if(d.length<=7) return d.replace(/(\d{3})(\d+)/,"$1-$2");
        return d.replace(/(\d{3})(\d{3,4})(\d{0,4})/,"$1-$2-$3");
      }
    }
    function formatBizNo(raw){
      const d = onlyDigits(raw).slice(0,10); // 10ìë¦¬
      if(d.length<=3) return d;
      if(d.length<=5) return d.replace(/(\d{3})(\d{0,2})/,"$1-$2");
      return d.replace(/(\d{3})(\d{2})(\d{0,5})/,"$1-$2-$3");
    }

    // === ìš”ì†Œ ì°¸ì¡° ===
    const bizTypeEl = document.getElementById('bizType');
    const foodSection = document.getElementById('foodSection');
    const hospitalSection = document.getElementById('hospitalSection');
    const btnFood = document.getElementById('btn-food');
    const btnHospital = document.getElementById('btn-hospital');
    const faqFood = document.getElementById('faq-food');
    const faqHospital = document.getElementById('faq-hospital');
    const resultEl=document.getElementById('result');
    const btn=document.getElementById('btnSubmit');

    // ì—…ì¢… í† ê¸€
    function setType(t){
      bizTypeEl.value=t;
      const isFood = t==='ì‹ë‹¹';
      foodSection.classList.toggle('hide', !isFood);
      hospitalSection.classList.toggle('hide', isFood);
      faqFood.classList.toggle('hide', !isFood);
      faqHospital.classList.toggle('hide', isFood);
      [btnFood,btnHospital].forEach(b=>b.style.borderColor='#2b2b2b');
      (isFood?btnFood:btnHospital).style.borderColor='var(--accent)';
      document.querySelectorAll('details').forEach(d=>d.open=false);
    }
    btnFood.onclick=()=>setType('ì‹ë‹¹');
    btnHospital.onclick=()=>setType('ë³‘ì›');

    // ìë™ í•˜ì´í”ˆ ë°”ì¸ë”©
    // ì‹ë‹¹
    r_phone.addEventListener('input', e=>{ e.target.value = formatPhone(e.target.value); });
    r_bizno.addEventListener('input', e=>{ e.target.value = formatBizNo(e.target.value); });
    // ë³‘ì›
    h_phone.addEventListener('input', e=>{ e.target.value = formatPhone(e.target.value); });
    h_bizno.addEventListener('input', e=>{ e.target.value = formatBizNo(e.target.value); });
    h_emr_phone.addEventListener('input', e=>{ e.target.value = formatPhone(e.target.value); });

    // ë°ì´í„° ìˆ˜ì§‘
    function collect(){
      const type=bizTypeEl.value;
      const payload={ì—…ì¢…:type, ì œì¶œì‹œê°:new Date().toISOString()};
      if(type==='ì‹ë‹¹'){
        payload.ì‹ë‹¹ì •ë³´={
          ì—…ì²´ëª…: r_name.value.trim(),
          ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: r_bizno.value.trim(),
          ë‹´ë‹¹ìëª…: r_person.value.trim(),
          ì—°ë½ì²˜: r_phone.value.trim()
        };
        payload.ê¸°ì¡´í¬ìŠ¤ì •ë³´={
          í”„ë¡œê·¸ë¨ëª…: r_pos_name.value.trim(),
          ê³„ì•½ì‹œì‘: r_contract_s.value,
          ê³„ì•½ì¢…ë£Œ: r_contract_e.value,
          ìœ„ì•½ê¸ˆ_ì²œì›: Number(r_penalty.value||0)
        };
        payload.ë‹¨ë§ê¸°ì •ë³´={ í¬ìŠ¤ê¸°ëŒ€ìˆ˜: Number(r_poscnt.value||0) };
        payload.ì „ë…„ë„ì¹´ë“œë§¤ì¶œ={
          ì´ì•¡_ë°±ë§Œì›: Number(r_sales_amt.value||0),
          ê±´ìˆ˜_ê±´: Number(r_sales_cnt.value||0)
        };
      }else{
        payload.ë³‘ì›ì •ë³´={
          ì—…ì²´ëª…: h_name.value.trim(),
          ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: h_bizno.value.trim(),
          ë‹´ë‹¹ìëª…: h_person.value.trim(),
          ì—°ë½ì²˜: h_phone.value.trim()
        };
        payload.EMR_ì—…ì²´ì •ë³´={
          ì—…ì²´ëª…: h_emr_name.value.trim(),
          ë‹´ë‹¹ìëª…: h_emr_person.value.trim(),
          ì—°ë½ì²˜: h_emr_phone.value.trim(),
          ë³€ê²½ê°€ëŠ¥ì—¬ë¶€: h_emr_switch.value
        };
        payload.VAN_ì—…ì²´ì •ë³´={
          ì—…ì²´ëª…: h_van_name.value.trim(),
          ê³„ì•½ì‹œì‘: h_van_contract_s.value,
          ê³„ì•½ì¢…ë£Œ: h_van_contract_e.value,
          ìœ„ì•½ê¸ˆ_ì²œì›: Number(h_van_penalty.value||0)
        };
        payload.ë¦¬ë”ê¸°ì •ë³´={ ëŒ€ìˆ˜: Number(h_reader_count.value||0) };
        payload.ì „ë…„ë„ì¹´ë“œë§¤ì¶œ={
          ë°±ë§Œì›ì´í•˜_ê±´ìˆ˜: Number(h_under_cnt.value||0),
          ë°±ë§Œì›ì´í•˜_í•©ê³„_ë°±ë§Œ: Number(h_under_amt.value||0),
          ë°±ë§Œì›ì´ìƒ_ê±´ìˆ˜: Number(h_over_cnt.value||0),
          ë°±ë§Œì›ì´ìƒ_í•©ê³„_ë°±ë§Œ: Number(h_over_amt.value||0)
        };
      }
      return payload;
    }

    // ê²€ì¦(í•„ìˆ˜ë§Œ)
    function validate(d){
      function mark(el, bad){ el.classList.toggle('error', !!bad); }
      if(d.ì—…ì¢…==='ì‹ë‹¹'){
        mark(r_name, !d.ì‹ë‹¹ì •ë³´.ì—…ì²´ëª…);
        mark(r_person, !d.ì‹ë‹¹ì •ë³´.ë‹´ë‹¹ìëª…);
        mark(r_phone, !d.ì‹ë‹¹ì •ë³´.ì—°ë½ì²˜);
        if(!d.ì‹ë‹¹ì •ë³´.ì—…ì²´ëª…) return 'ì‹ë‹¹ ì—…ì²´ëª…ì€ í•„ìˆ˜';
        if(!d.ì‹ë‹¹ì •ë³´.ë‹´ë‹¹ìëª…) return 'ì‹ë‹¹ ë‹´ë‹¹ìëª…ì€ í•„ìˆ˜';
        if(!d.ì‹ë‹¹ì •ë³´.ì—°ë½ì²˜) return 'ì‹ë‹¹ ì—°ë½ì²˜ëŠ” í•„ìˆ˜';
      }else{
        mark(h_name, !d.ë³‘ì›ì •ë³´.ì—…ì²´ëª…);
        mark(h_person, !d.ë³‘ì›ì •ë³´.ë‹´ë‹¹ìëª…);
        mark(h_phone, !d.ë³‘ì›ì •ë³´.ì—°ë½ì²˜);
        if(!d.ë³‘ì›ì •ë³´.ì—…ì²´ëª…) return 'ë³‘ì› ì—…ì²´ëª…ì€ í•„ìˆ˜';
        if(!d.ë³‘ì›ì •ë³´.ë‹´ë‹¹ìëª…) return 'ë³‘ì› ë‹´ë‹¹ìëª…ì€ í•„ìˆ˜';
        if(!d.ë³‘ì›ì •ë³´.ì—°ë½ì²˜) return 'ë³‘ì› ì—°ë½ì²˜ëŠ” í•„ìˆ˜';
      }
      return '';
    }

    // ì œì¶œ
    const submit = async ()=>{
      const data=collect();
      const err=validate(data);
      if(err){resultEl.innerHTML='<span class="err">ì˜¤ë¥˜: '+err+'</span>';return;}
      btn.disabled=true; resultEl.innerHTML='<span class="spinner"></span>ì œì¶œ ì¤‘...';
      try{
        const res = await fetch(WEB_APP_URL, {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(data)});
        const json = await res.json();
        if(json && json.result==='success'){
          resultEl.innerHTML='<span class="ok">ì œì¶œ ì™„ë£Œ. 1ì£¼ì¼ ë‚´ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</span>';
          btn.disabled=false; return;
        }
      }catch(_){}
      try{
        await fetch(WEB_APP_URL, {method:'POST', mode:'no-cors', body: JSON.stringify(data)});
        resultEl.innerHTML='<span class="ok">ì œì¶œ ì™„ë£Œ(í™•ì¸). ì‹œíŠ¸ì—ì„œ ê¸°ë¡ ì—¬ë¶€ í™•ì¸í•˜ì„¸ìš”.</span>';
      }catch(e){
        resultEl.innerHTML='<span class="err">ì „ì†¡ ì‹¤íŒ¨. ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•˜ì„¸ìš”.</span>';
      }finally{
        btn.disabled=false;
      }
    };
    btn.onclick=submit;

    // ì´ˆê¸°
    setType('ì‹ë‹¹');
  </script>
</body>
</html>
